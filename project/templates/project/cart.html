{% extends 'project/base.html' %}

{% block title %}Cart{% endblock %}

{% block content %}
<div class="container">
    <h2>Your Cart</h2>

    <!-- Unsold Items -->
    {% if unsold_items %}
        <h3>Items Available for Purchase</h3>
        {% for item in unsold_items %}
            <div class="card">
                <img src="{{ item.listing.image.url }}" alt="{{ item.listing.name }}" class="listing-image">
                <div class="card-details">
                    <h3>{{ item.listing.name }}</h3>
                    <p>Price: ${{ item.listing.price }}</p>
                </div>
                <form method="post" action="{% url 'remove_from_cart' item.id %}">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-danger">Remove</button>
                </form>
            </div>
        {% endfor %}

        <div class="checkout-container">
            <p>Total Price: ${{ cart.total_price }}</p>
            <a href="{% url 'checkout_cart' %}" class="btn btn-primary">Proceed to Checkout</a>
        </div>
    {% else %}
        <h2>Your cart is empty or all items are sold.</h2>
    {% endif %}

    <!-- Sold Items -->
    {% if sold_items %}
        <h3>Sold Items</h3>
        {% for item in sold_items %}
            <div class="card">
                <img src="{{ item.listing.image.url }}" alt="{{ item.listing.name }}" class="listing-image">
                <div class="card-details">
                    <h3>{{ item.listing.name }}</h3>
                    <p>Price: ${{ item.listing.price }}</p>
                    <p class="text-danger">This item is already sold.</p>
                </div>
                <form method="post" action="{% url 'remove_from_cart' item.id %}">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-danger">Remove</button>
                </form>
            </div>
        {% endfor %}
    {% endif %}
</div>
{% endblock %}
